kind: LongDurationCondition
name: Check Trace Duration
style: condition
type: base
status: alpha
version: v0.1.0
summary: Check if the root span duration of a trace exceeds a specified value.
description: |-
  Check the duration of the root span in a trace. If the root span exceeds the specified duration, the will condition evaluate to true.
tags:
  - category:condition
  - service:refinery
  - vendor:Honeycomb
  - type:error
  - input:SampleData
  - output:SampleData
ports:
  # inputs
  - name: Match
    direction: input
    type: SampleData
  # outputs
  - name: And
    direction: output
    type: SampleData
properties:
  - name: Duration
    type: int
    default: 1000
    validations:
      - positive
templates:
  - kind: refinery_rules
    name: LongDurationCondition
    format: rules
    meta:
      condition: true
    data:
      - key: Field
        value: duration_ms
      - key: Operator
        value: ">="
      - key: Value
        value: "{{ .Values.Duration | encodeAsInt }}"
      - key: Datatype
        value: int
