kind: ExtractLogAttributesProcessor
name: Extract Log Attributes
style: processor
type: base
status: development
version: v0.0.1
summary: Extracts log attributes from the log body
description: |-
  This processor extracts fields from the log body and merges them into the log attributes.
  If a log field is specified, it extracts attributes from that field within the log body.
tags:
  - category:processor
  - service:collector
  - signal:OTelLogs
ports:
  # inputs
  - name: Logs
    direction: input
    type: OTelLogs
  # outputs
  - name: Logs
    direction: output
    type: OTelLogs
properties:
  - name: Field
    type: string
templates:
  - kind: collector_config
    name: otel_extract_log_attributes
    format: collector
    meta:
      componentSection: processors
      signalTypes: [logs]
      collectorComponentName: transform
    data:
      - key: "{{ .ComponentName }}.error_mode"
        value: "ignore"
      - key: "{{ .ComponentName }}.log_statements[0]"
        value: "merge_maps(attributes, body, \"upsert\") where IsMap(body)"
        suppress_if: '{{ .Values.Field }}'
      - key: "{{ .ComponentName }}.log_statements[0]"
        value: "merge_maps(attributes, body[\"{{ .Values.Field }}\"], \"upsert\") where IsMap(body) and body[\"{{ .Values.Field }}\"] != nil"
        suppress_if: '{{ not .Values.Field }}'
